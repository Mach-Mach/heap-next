---
title: 'Adaptive Dense Reward: Understanding the Gap Between Action and Reward Space in Alignment'
date: 2024-10-23
tags: ['Large Language Models', 'token-wise RLHF', 'evaluation metrics', 'subsequence-level supervision', 'adversarial samples', 'GSM8K', 'hallucinations', 'MMLU', 'Reinforcement Learning from Human Feedback', 'sample-level supervision', 'catastrophic forgetting', 'dense reward methods', 'Adaptive Message-wise RLHF', 'pivot tokens', 'HumanEval']
categories: ['cs.AI', 'cs.CL', 'cs.LG']
problem: Adaptive Message-wise RLHF method
solution: suboptimal learning process in RLHF
pdf_url: http://arxiv.org/pdf/2411.00809v1
arx_url: http://arxiv.org/abs/2411.00809v1
score: 5
authors: ['Yanshi Li', 'Shaopan Xiong', 'Gengru Chen', 'Xiaoyang Li', 'Yijia Luo', 'Xingyao Zhang', 'Yanhui Huang', 'Xingyuan Bu', 'Yingshui Tan', 'Chun Yuan', 'Jiamang Wang', 'Wenbo Su', 'Bo Zheng']
affiliations_aligned: ['Alibaba Group', 'Alibaba Group', 'Alibaba Group, Tsinghua University', 'Alibaba Group', 'Alibaba Group', 'Alibaba Group', 'Alibaba Group', 'Alibaba Group', 'Alibaba Group', 'Tsinghua University', 'Alibaba Group', 'Alibaba Group', 'Alibaba Group']
affiliations: ['Alibaba Group, Tsinghua University', 'Tsinghua University', 'Alibaba Group']
---


Reinforcement Learning from Human Feedback (RLHF) has proven highly effective in aligning Large Language Models (LLMs) with human preferences. However, the original RLHF typically optimizes under an overall reward, which can lead to a suboptimal learning process. This limitation stems from RLHF's lack of awareness regarding which specific tokens should be reinforced or suppressed. Moreover, conflicts in supervision can arise, for instance, when a chosen response includes erroneous tokens, while a rejected response contains accurate elements. To rectify these shortcomings, increasing dense reward methods, such as step-wise and token-wise RLHF, have been proposed. However, these existing methods are limited to specific tasks (like mathematics). In this paper, we propose the ``Adaptive Message-wise RLHF'' method, which robustly applies to various tasks. By defining pivot tokens as key indicators, our approach adaptively identifies essential information and converts sample-level supervision into fine-grained, subsequence-level supervision. This aligns the density of rewards and action spaces more closely with the information density of the input. Experiments demonstrate that our method can be integrated into various training methods, significantly mitigating hallucinations and catastrophic forgetting problems while outperforming other methods on multiple evaluation metrics. Our method improves the success rate on adversarial samples by 10\% compared to the sample-wise approach and achieves a 1.3\% improvement on evaluation benchmarks such as MMLU, GSM8K, and HumanEval et al.