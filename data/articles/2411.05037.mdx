---
title: Towards Interpreting Language Models: A Case Study in Multi-Hop   Reasoning
date: 2024-11-06
tags: ['Attention Lens', 'multi-hop reasoning', 'language models', 'attention heads', 'information retrieval', 'memory injections', 'model interpretation', 'GPT-2']
categories: ['cs.CL', 'cs.AI', 'cs.LG']
problem: targeted memory injections on LM attention heads
solution: ['multi-hop reasoning failures in language models']
pdf_url: http://arxiv.org/pdf/2411.05037v1
arx_url: http://arxiv.org/abs/2411.05037v1
score: 5
authors: ['Mansi Sakarvadia']
affiliations_aligned: ['Department of Biology, University of XYZ']
affiliations: ['Department of Biology, University of XYZ']
---


Answering multi-hop reasoning questions requires retrieving and synthesizing information from diverse sources. Language models (LMs) struggle to perform such reasoning consistently. We propose an approach to pinpoint and rectify multi-hop reasoning failures through targeted memory injections on LM attention heads. First, we analyze the per-layer activations of GPT-2 models in response to single- and multi-hop prompts. We then propose a mechanism that allows users to inject relevant prompt-specific information, which we refer to as "memories," at critical LM locations during inference. By thus enabling the LM to incorporate additional relevant information during inference, we enhance the quality of multi-hop prompt completions. We empirically show that a simple, efficient, and targeted memory injection into a key attention layer often increases the probability of the desired next token in multi-hop tasks, by up to 424%. We observe that small subsets of attention heads can significantly impact the model prediction during multi-hop reasoning. To more faithfully interpret these heads, we develop Attention Lens: an open source tool that translates the outputs of attention heads into vocabulary tokens via learned transformations called lenses. We demonstrate the use of lenses to reveal how a model arrives at its answer and use them to localize sources of model failures such as in the case of biased and malicious language generation.