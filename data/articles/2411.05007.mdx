---
title: 'SVDQunat: Absorbing Outliers by Low-Rank Components for 4-Bit Diffusion Models'
date: 2024-11-08
tags: ['image quality', 'inference engine', 'Singular Value Decomposition', 'latency', 'memory usage', 'open-source', 'diffusion models', 'low-rank components', 'quantization', '4-bit quantization']
categories: ['cs.CV', 'cs.LG']
problem: SVDQuant quantization paradigm
solution: high memory usage and latency in large diffusion models
pdf_url: https://arxiv.org/pdf/2411.05007
arx_url: https://arxiv.org/abs/2411.05007
score: 4
authors: ['Muyang Li', 'Yujun Lin', 'Zhekai Zhang', 'Tianle Cai', 'Xiuyu Li', 'Junxian Guo', 'Enze Xie', 'Chenlin Meng', 'Jun-Yan Zhu', 'Song Han']
affiliations_aligned: ['MIT', 'MIT', 'MIT', 'Princeton', 'UC Berkeley', 'MIT, SJTU', 'NVIDIA', 'Pika Labs', 'CMU', 'MIT, NVIDIA']
affiliations: ['Princeton', 'UC Berkeley', 'Pika Labs', 'MIT, NVIDIA', 'NVIDIA', 'CMU', 'MIT', 'MIT, SJTU']
---


Diffusion models have been proven highly effective at generating high-quality images. However, as these models grow larger, they require significantly more memory and suffer from higher latency, posing substantial challenges for deployment. In this work, we aim to accelerate diffusion models by quantizing their weights and activations to 4 bits. At such an aggressive level, both weights and activations are highly sensitive, where conventional post-training quantization methods for large language models like smoothing become insufficient. To overcome this limitation, we propose SVDQuant, a new 4-bit quantization paradigm. Different from smoothing which redistributes outliers between weights and activations, our approach absorbs these outliers using a low-rank branch. We first consolidate the outliers by shifting them from activations to weights, then employ a high-precision low-rank branch to take in the weight outliers with Singular Value Decomposition (SVD). This process eases the quantization on both sides. However, na\"{\i}vely running the low-rank branch independently incurs significant overhead due to extra data movement of activations, negating the quantization speedup. To address this, we co-design an inference engine Nunchaku that fuses the kernels of the low-rank branch into those of the low-bit branch to cut off redundant memory access. It can also seamlessly support off-the-shelf low-rank adapters (LoRAs) without the need for re-quantization. Extensive experiments on SDXL, PixArt-$\Sigma$, and FLUX.1 validate the effectiveness of SVDQuant in preserving image quality. We reduce the memory usage for the 12B FLUX.1 models by 3.5$\times$, achieving 3.0$\times$ speedup over the 4-bit weight-only quantized baseline on the 16GB laptop 4090 GPU, paving the way for more interactive applications on PCs. Our quantization library and inference engine are open-sourced.